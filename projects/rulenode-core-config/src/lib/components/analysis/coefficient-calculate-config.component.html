<section [formGroup]="coefficientCalculateForm" fxLayout="column">
  <label translate class="tb-title no-padding">tb.rulenode.latest-timeseries</label>
  <mat-form-field floatLabel="always" class="mat-block">
    <mat-label></mat-label>
    <mat-chip-list #latestTimeseriesChipList>
      <mat-chip
        *ngFor="let key of coefficientCalculateForm.get('latestTsKeyNames').value;"
        (removed)="removeKey(key, 'latestTsKeyNames')">
        {{key}}
        <mat-icon matChipRemove>close</mat-icon>
      </mat-chip>
      <input matInput type="text" placeholder="{{'tb.rulenode.latest-timeseries' | translate}}"
             style="max-width: 200px;"
             [matChipInputFor]="latestTimeseriesChipList"
             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
             (matChipInputTokenEnd)="addKey($event, 'latestTsKeyNames')"
             [matChipInputAddOnBlur]="true">
    </mat-chip-list>
  </mat-form-field>
  <label translate class="tb-title no-padding">tb.rulenode.coefficient-calculate-timeseries</label>
  <mat-form-field floatLabel="always" class="mat-block">
    <mat-label></mat-label>
    <mat-chip-list #timeseriesChipList>
      <mat-chip
        *ngFor="let key of coefficientCalculateForm.get('tsKeyNames').value;"
        (removed)="removeKey(key, 'tsKeyNames')">
        {{key}}
        <mat-icon matChipRemove>close</mat-icon>
      </mat-chip>
      <input matInput type="text" placeholder="{{'tb.rulenode.coefficient-calculate-timeseries' | translate}}"
             style="max-width: 200px;"
             [matChipInputFor]="timeseriesChipList"
             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
             (matChipInputTokenEnd)="addKey($event, 'tsKeyNames')"
             [matChipInputAddOnBlur]="true">
    </mat-chip-list>
  </mat-form-field>
  <label translate class="tb-title no-padding">tb.rulenode.server-attributes</label>
  <mat-form-field floatLabel="always" class="mat-block">
    <mat-label></mat-label>
    <mat-chip-list #serverAttributesChipList>
      <mat-chip
        *ngFor="let key of coefficientCalculateForm.get('serverAttributeNames').value;"
        (removed)="removeKey(key, 'serverAttributeNames')">
        {{key}}
        <mat-icon matChipRemove>close</mat-icon>
      </mat-chip>
      <input matInput type="text" placeholder="{{'tb.rulenode.server-attributes' | translate}}"
             style="max-width: 200px;"
             [matChipInputFor]="serverAttributesChipList"
             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
             (matChipInputTokenEnd)="addKey($event, 'serverAttributeNames')"
             [matChipInputAddOnBlur]="true">
    </mat-chip-list>
  </mat-form-field>
  <label translate class="tb-title no-padding">tb.rulenode.client-attributes</label>
  <mat-form-field floatLabel="always" class="mat-block">
    <mat-label></mat-label>
    <mat-chip-list #clientAttributesChipList>
      <mat-chip
        *ngFor="let key of coefficientCalculateForm.get('clientAttributeNames').value;"
        (removed)="removeKey(key, 'clientAttributeNames')">
        {{key}}
        <mat-icon matChipRemove>close</mat-icon>
      </mat-chip>
      <input matInput type="text" placeholder="{{'tb.rulenode.client-attributes' | translate}}"
             style="max-width: 200px;"
             [matChipInputFor]="clientAttributesChipList"
             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
             (matChipInputTokenEnd)="addKey($event, 'clientAttributeNames')"
             [matChipInputAddOnBlur]="true">
    </mat-chip-list>
  </mat-form-field>
  <label translate class="tb-title no-padding">tb.rulenode.shared-attributes</label>
  <mat-form-field floatLabel="always" class="mat-block">
    <mat-label></mat-label>
    <mat-chip-list #sharedAttributesChipList>
      <mat-chip
        *ngFor="let key of coefficientCalculateForm.get('sharedAttributeNames').value;"
        (removed)="removeKey(key, 'sharedAttributeNames')">
        {{key}}
        <mat-icon matChipRemove>close</mat-icon>
      </mat-chip>
      <input matInput type="text" placeholder="{{'tb.rulenode.shared-attributes' | translate}}"
             style="max-width: 200px;"
             [matChipInputFor]="sharedAttributesChipList"
             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
             (matChipInputTokenEnd)="addKey($event, 'sharedAttributeNames')"
             [matChipInputAddOnBlur]="true">
    </mat-chip-list>
  </mat-form-field>
  <label translate class="tb-title tb-required">tb.rulenode.specific.value-formula</label>
  <tb-kv-map-config
    required
    formControlName="formula"
    requiredText="tb.rulenode.specific.value-formula-key-required"
    keyText="tb.rulenode.specific.value-formula-key"
    keyRequiredText="tb.rulenode.specific.value-formula-key-required"
    valText="tb.rulenode.specific.value-formula-value"
    valRequiredText="tb.rulenode.specific.value-formula-value-required">
  </tb-kv-map-config>
  <label translate class="tb-title no-padding">tb.rulenode.minute.interval.compute.filter-type</label>
  <mat-form-field fxFlex class="mat-block">
    <mat-select formControlName="filterType">
      <mat-option *ngFor="let type of filterTypes" [value]="type">
        {{ filterTypeTranslation.get(type) | translate }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-label></mat-label>
  <mat-checkbox fxFlex formControlName="likeFilter" style="padding-bottom: 16px;">
    {{ 'tb.rulenode.specific.value-like-filter' | translate }}
  </mat-checkbox>
  <label translate class="tb-title no-padding">tb.rulenode.minute.interval.compute.filter-entity</label>
  <mat-form-field fxFlex floatLabel="always" class="mat-block">
    <mat-label></mat-label>
    <mat-chip-list #filterEntityChipList>
      <mat-chip
        *ngFor="let key of coefficientCalculateForm.get('filterEntityNames').value;"
        (removed)="removeKey(key, 'filterEntityNames')">
        {{key}}
        <mat-icon matChipRemove>close</mat-icon>
      </mat-chip>
      <input matInput type="text" placeholder="{{'tb.rulenode.list-entity-name' | translate}}"
             [matChipInputFor]="filterEntityChipList"
             [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
             (matChipInputTokenEnd)="addKey($event, 'filterEntityNames')"
             [matChipInputAddOnBlur]="true"/>
    </mat-chip-list>
  </mat-form-field>
</section>
